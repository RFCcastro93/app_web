{% extends "base.html" %}

{% block title %}Publicar Novo Servi√ßo{% endblock %}

{% block content %}
<h1>üìë Publicar Novo Servi√ßo</h1>
<!-- Banner de Onboarding -->
<div class="card onboard-card">
  <div class="onboard-head">
    <div>
      <b>Status do seu cadastro</b> ¬∑ 3 etapas
      <span class="muted">({{ onboarding.percent }}%)</span>
    </div>
    <div class="onboard-steps">
      <span class="pill {{ 'pill-ok' if onboarding.step1 else 'pill-no' }}">
        {{ '‚úì' if onboarding.step1 else '‚Ä¢' }} Etapa 1
      </span>
      <span class="pill {{ 'pill-ok' if onboarding.step2 else 'pill-no' }}">
        {{ '‚úì' if onboarding.step2 else '‚Ä¢' }} Etapa 2
      </span>
      <span class="pill {{ 'pill-ok' if onboarding.step3 else 'pill-no' }}">
        {{ '‚úì' if onboarding.step3 else '‚Ä¢' }} Etapa 3
      </span>
    </div>
  </div>

  <!-- Barra de progresso -->
  <div class="onboard-progress">
    <div class="onboard-progress-bar" style="width: {{ onboarding.percent }}%;"></div>
  </div>

  <!-- A√ß√µes: mostrar s√≥ as etapas faltantes -->
  <div class="onboard-actions">
    {% if not onboarding.step1 %}
      <a class="button sm" href="{{ url_for('contractor_step1') }}">Ir para Etapa 1</a>
    {% endif %}
    {% if not onboarding.step2 %}
      <a class="button sm" href="{{ url_for('contractor_step2') }}">Ir para Etapa 2</a>
    {% endif %}
    {% if not onboarding.step3 %}
      <a class="button sm" href="{{ url_for('contractor_step3') }}">Ir para Etapa 3</a>
    {% endif %}
  </div>

  <!-- Avisos (se houver) -->
  {% if onboarding.warnings and onboarding.warnings|length > 0 %}
    <ul class="onboard-warnings">
      {% for w in onboarding.warnings %}
        <li>‚ö†Ô∏è {{ w }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  
<!-- Exibindo status das etapas -->
<div class="status-cadastro">
  <p>Status do seu cadastro: <strong>3 etapas</strong> ({{ onboarding.percent }}%)</p>
  <p class="steps">
    <span class="step {{ 'completed' if onboarding.step1 else '' }}">Etapa 1 (Dados B√°sicos)</span> 
    <span class="step {{ 'completed' if onboarding.step2 else '' }}">Etapa 2 (Documentos)</span>
    <span class="step {{ 'completed' if onboarding.step3 else '' }}">Etapa 3 (Termo de Conduta)</span>
  </p>
  <p class="message">
    <span class="warning" {% if not onboarding.step1 %} style="display: inline;" {% else %} style="display: none;" {% endif %}>‚ö†Ô∏è Complete a Etapa 1 (Dados B√°sicos).</span>
    <span class="warning" {% if not onboarding.step2 %} style="display: inline;" {% else %} style="display: none;" {% endif %}>‚ö†Ô∏è Complete a Etapa 2 (Documentos).</span>
    <span class="warning" {% if not onboarding.step3 %} style="display: inline;" {% else %} style="display: none;" {% endif %}>‚ö†Ô∏è Assine a Etapa 3 (Termo de Conduta).</span>
  </p>
  <div class="buttons">
    <a href="{{ url_for('contractor_step1') }}" class="button {{ 'disabled' if onboarding.step1 }}">Ir para Etapa 1</a>
    <a href="{{ url_for('contractor_step2') }}" class="button {{ 'disabled' if not onboarding.step1 }}">Ir para Etapa 2</a>
    <a href="{{ url_for('contractor_step3') }}" class="button {{ 'disabled' if not onboarding.step2 }}">Ir para Etapa 3</a>
  </div>
</div>

<!-- Formul√°rio de Publica√ß√£o -->
<form method="POST">
  <label for="title">T√≠tulo do servi√ßo</label>
  <input type="text" name="title" id="title" required>

  <label for="description">Descri√ß√£o</label>
 <textarea name="description" id="description" required style="width: 100%; height: 100px;"></textarea>

  <label for="category">Categoria</label>
  <input type="text" name="category" id="category" required>

  <label for="location">Localiza√ß√£o</label>
  <input type="text" name="location" id="location" required>

  <label for="price_range">Faixa de pre√ßo (ex: 1000-2000)</label>
  <input type="text" name="price_range" id="price_range" required>

  <button type="submit" class="button">Publicar</button>
</form>

{% endblock %}
